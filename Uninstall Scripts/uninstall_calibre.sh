#!/bin/bash
# Uninstall script for calibre
# Generated by IntuneBrew

# Exit on error
set -e

echo "Uninstalling calibre..."

# Check if running as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root"
  exit 1
fi

# Kill application process if running
echo "Stopping calibre if running..."
pkill -f "calibre" 2>/dev/null || true

# Remove /Applications/calibre.app
echo "Removing /Applications/calibre.app..."
if [ -d "/Applications/calibre.app" ]; then
    rm -rf "/Applications/calibre.app" 2>/dev/null || true
elif [ -f "/Applications/calibre.app" ]; then
    rm -f "/Applications/calibre.app" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-complete
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-complete..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-complete" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-complete" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-customize
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-customize..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-customize" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-customize" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-debug
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-debug..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-debug" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-debug" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-parallel
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-parallel..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-parallel" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-parallel" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-server
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-server..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-server" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-server" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-smtp
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibre-smtp..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-smtp" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibre-smtp" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibredb
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/calibredb..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibredb" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/calibredb" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-convert
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-convert..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-convert" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-convert" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-device
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-device..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-device" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-device" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-meta
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-meta..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-meta" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-meta" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-polish
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-polish..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-polish" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-polish" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-viewer
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-viewer..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-viewer" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-viewer" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/fetch-ebook-metadata
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/fetch-ebook-metadata..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/fetch-ebook-metadata" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/fetch-ebook-metadata" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrf2lrs
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrf2lrs..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrf2lrs" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrf2lrs" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrfviewer
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrfviewer..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrfviewer" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrfviewer" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrs2lrf
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/lrs2lrf..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrs2lrf" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/lrs2lrf" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/markdown-calibre
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/markdown-calibre..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/markdown-calibre" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/markdown-calibre" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/web2disk
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/web2disk..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/web2disk" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/web2disk" 2>/dev/null || true
fi

# Remove binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-edit
echo "Removing binary /Applications/calibre.app/calibre.app/Contents/MacOS/ebook-edit..."
if [ -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-edit" ]; then
    rm -f "/Applications/calibre.app/calibre.app/Contents/MacOS/ebook-edit" 2>/dev/null || true
fi

# Remove $HOME/Library/Application Support/calibre-ebook.com
echo "Removing $HOME/Library/Application Support/calibre-ebook.com..."
if [ -d "$HOME/Library/Application Support/calibre-ebook.com" ]; then
    rm -rf "$HOME/Library/Application Support/calibre-ebook.com" 2>/dev/null || true
elif [ -f "$HOME/Library/Application Support/calibre-ebook.com" ]; then
    rm -f "$HOME/Library/Application Support/calibre-ebook.com" 2>/dev/null || true
fi

# Remove $HOME/Library/Caches/calibre
echo "Removing $HOME/Library/Caches/calibre..."
if [ -d "$HOME/Library/Caches/calibre" ]; then
    rm -rf "$HOME/Library/Caches/calibre" 2>/dev/null || true
elif [ -f "$HOME/Library/Caches/calibre" ]; then
    rm -f "$HOME/Library/Caches/calibre" 2>/dev/null || true
fi

# Remove $HOME/Library/Preferences/calibre
echo "Removing $HOME/Library/Preferences/calibre..."
if [ -d "$HOME/Library/Preferences/calibre" ]; then
    rm -rf "$HOME/Library/Preferences/calibre" 2>/dev/null || true
elif [ -f "$HOME/Library/Preferences/calibre" ]; then
    rm -f "$HOME/Library/Preferences/calibre" 2>/dev/null || true
fi

# Remove $HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist
echo "Removing $HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist..."
if [ -d "$HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist" ]; then
    rm -rf "$HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist" 2>/dev/null || true
elif [ -f "$HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist" ]; then
    rm -f "$HOME/Library/Preferences/com.calibre-ebook.ebook-viewer.plist" 2>/dev/null || true
fi

# Remove $HOME/Library/Preferences/net.kovidgoyal.calibre.plist
echo "Removing $HOME/Library/Preferences/net.kovidgoyal.calibre.plist..."
if [ -d "$HOME/Library/Preferences/net.kovidgoyal.calibre.plist" ]; then
    rm -rf "$HOME/Library/Preferences/net.kovidgoyal.calibre.plist" 2>/dev/null || true
elif [ -f "$HOME/Library/Preferences/net.kovidgoyal.calibre.plist" ]; then
    rm -f "$HOME/Library/Preferences/net.kovidgoyal.calibre.plist" 2>/dev/null || true
fi

# Remove $HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState
echo "Removing $HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState..."
if [ -d "$HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState" ]; then
    rm -rf "$HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState" 2>/dev/null || true
elif [ -f "$HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState" ]; then
    rm -f "$HOME/Library/Saved Application State/com.calibre-ebook.ebook-viewer.savedState" 2>/dev/null || true
fi

# Remove $HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState
echo "Removing $HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState..."
if [ -d "$HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState" ]; then
    rm -rf "$HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState" 2>/dev/null || true
elif [ -f "$HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState" ]; then
    rm -f "$HOME/Library/Saved Application State/net.kovidgoyal.calibre.savedState" 2>/dev/null || true
fi

echo "Uninstallation complete!"
exit 0
